load("//vulkan_rules:shader.bzl", "glsl_shader")
load("//vulkan_rules:shader.bzl", "cc_shader_library")

glsl_shader(
    name = "vkllama_comp_shaders",
    shaders = [
        "vec_mul_add.comp", 
        "rms_norm.comp",
        "rms_norm_fp16.comp",
        "element_wise.comp",
        "element_wise_fp16.comp",
        "element_wise_fp16a.comp",
        "element_wise_constant.comp",
        "element_wise_constant_fp16.comp",
        "element_wise_constant_fp16a.comp",
        "matmul_broadcast0.comp",
        "matmul_broadcast1.comp",
        "matmul_broadcast2.comp",
        "matmul_broadcast0_fp16.comp",
        "matmul_broadcast1_fp16.comp",
        "matmul_broadcast2_fp16.comp",
        "matmul_broadcast0_fp16a.comp",
        "matmul_broadcast1_fp16a.comp",
        "matmul_broadcast2_fp16a.comp",
        "matmul_broadcast0_fp16_v2.comp",
        "matmul_broadcast1_fp16_v2.comp",
        "matmul_broadcast2_fp16_v2.comp",
        "matmul_broadcast0_fp16a_v2.comp",
        "matmul_broadcast1_fp16a_v2.comp",
        "matmul_broadcast2_fp16a_v2.comp",
        "rope.comp",
        "rope_fp16.comp",
        "reduce.comp",
        "reduce_fp16.comp",
        "softmax_stage0.comp",
        "softmax_stage1.comp",
        "softmax_stage2.comp",
        "softmax_stage0_fp16.comp",
        "softmax_stage0_fp16a.comp",
        "softmax_stage1_fp16a.comp",
        "softmax_stage2_fp16.comp",
        "softmax_stage2_fp16a.comp",
        "concat.comp",
        "concat_fp16.comp",
        "update_kvcache_fp16.comp",
        "slice.comp",
        "slice_fp16.comp",
        "embedding.comp",
        "embedding_fp16.comp",
        "argmax_stage0.comp",
        "argmax_stage1.comp",
        "argmax_stage0_fp16.comp",
        "argmax_stage0_fp16a.comp",
        "argmax_stage1_fp16a.comp",
        "cast_fp32_to_fp16.comp",
        "cast_fp16_to_fp32.comp",
        "transpose_type0.comp",
        "transpose_type0_fp16.comp",
    ],
    extra_args = [
        "--target-spv=spv1.3",
    ],
    tool = '//tools:binary_to_array',
    visibility = ["//visibility:public"]
)

cc_shader_library(
    name = 'vkllama_shaders',
    deps = [':vkllama_comp_shaders'],
    visibility = ["//visibility:public"]
)
